#!/bin/sh
#
# finger.sh
# Created by Hayden Hamilton
#
# hayden@haydenvh.com
# Copyright (c) 2020 Hayden Hamilton
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
#
# This work is free. You can redistribute it and/or modify it under the      
# terms of the Do What The Fuck You Want To Public License, Version 2,       
# as published by Sam Hocevar. See http://www.wtfpl.net/ for more details.   

# usage: finger [user]@<host>
# tries to ssh into machine if port 79 is not exposed

user=${1%%@*}
hostport="${1#*@}"
host=${hostport%:*}
echo "$host" | grep ':' >/dev/null && port=${hostport##*:}

(
	[ -z $user ] && {
		printf "\r\n" | nc ${host:-localhost} ${port:-79}
	} || {
		printf "$user\r\n" | nc ${host:-localhost} ${port:-79}
	}
) | tr -d '\r'
