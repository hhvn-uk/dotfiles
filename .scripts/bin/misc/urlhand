#!/bin/sh

link=$(grep -Eo '[A-Za-z][A-Za-z]*://\S*' < /dev/stdin 2>/dev/null | awk '{print $1}' | dmenu -i -p 'Select url')
[ "$link" = "" ] && exit 1

tor=$(printf "yes\nno" | dmenu -i -p "Tor?")

hand=$(printf "mpvms video
mpvms
popupmpv
youtube-dl --add-metadata -ic
youtube-dl --add-metadata -xic
vimb --no-maximize
toxclip
netimg
netvid
popupcurl
popupcgo" | dmenu -i -p "Select a handler:")

hmpv pause /tmp/mpv-socket
[ "$tor" = "yes" ] && sh -c "torsocks $hand $link" || sh -c "$hand $link"
