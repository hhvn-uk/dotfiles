#!/bin/sh

link=$(grep -Eo '[A-Za-z][A-Za-z]*://[^ ]*' < /dev/stdin 2>/dev/null | sed 's/[>,:)]$//' | dmenu -i)
[ "$link" = "" ] && exit 1

hand=$(printf "mpvms video
mpvms
mpv --pause
popupmpv
youtube-dl --add-metadata -ic
youtube-dl --add-metadata -xic
$(xprop -id $(cat /tmp/tabbed.xid) >/dev/null && echo "surf -e $(cat /tmp/tabbed.xid)" || echo ">/tmp/tabbed.xid tabbed -cr2 surf -e ''")
toxclip
netimg
netvid
popupcurl
popupcgo
torsocks mpvms video
torsocks mpvms
torsocks mpv --pause
torsocks popupmpv
torsocks youtube-dl --add-metadata -ic
torsocks youtube-dl --add-metadata -xic
torsocks $(xprop -id $(cat /tmp/tabbed.xid) >/dev/null && echo "surf -e $(cat /tmp/tabbed.xid)" || echo ">/tmp/tabbed.xid tabbed -cr2 surf -e ''")
torsocks netimg
torsocks popupcurl
torsocks popupcgo" | dmenu -i)

sh -c "$hand $link"
