#!/bin/rc

cmus-remote -Q | awk '
/status paused/ { 
	print "[^c#7777cc^Paused]"
	exit(1) 
}

/^tag/ {
	name = $0
	sub(/[^ ]* /, "", name)
	sub(/ .*/, "", name)
	sub(/[^ ]* [^ ]* /, "")
	metadata[name] = $0
	p = 1
}

END {
	if (p == 1) {
		printf("[%s - %s - %s. %s]", 
			metadata["artist"], 
			metadata["album"], 
			metadata["tracknumber"], 
			metadata["title"])
	}
}' | tee curtxt
